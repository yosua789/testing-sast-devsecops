{%- extends "layout/base.html" -%}
{%- block content -%}
<div class="container-fluid py-4">
    <div class="row my-4">
        <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
            <div class="card">
                <div class="card-header pb-0">
                    <div class="row">
                        <div class="col-lg-6 col-7">
                            <h6>Add File</h6>
                        </div>
                    </div>
                </div>

                <div class="card-body px-4 pb-2">
                    <div>
                        <div class="mb-3">
                            <select class="form-select" id="path" aria-label="Default select example">
                                {%for i in log%}
                                <option value="{{i.id}}">{{i.docker_path}}</option>
                                
                                {%endfor%}
                              </select>
                        </div>
                        <div class="mb-3">
                            <label for="cctvName" class="form-label">Log name</label>
                            <input type="text" name="name" class="form-control" id="file" placeholder="Log name">
                        </div>
                        
                        <div class="d-flex justify-content-end">
                            <button class="btn btn-primary" id="addFile">Add Log</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


</main>


{%- endblock -%}
{%- block extrajs -%}
<script>
    $(document).ready(function () {
        $("#addFile").click(function () {
            var file = $("#file").val()
            var path = $("#path").val()

            var postData = new FormData()

            postData.append('filename', file)
            postData.append('path', path)
            

            $.ajax({
                url: '/logfile/add-filelog', 
                type: 'POST',
                data: postData,
                processData: false, // Prevent jQuery from automatically processing the data
                contentType: false, // Let the server handle the Content-Type
                success: function (res) {  
                    console.log(res)
                    if (res.status == 200) {
                        $("#ModalSuccess").modal('show')
                        $("#modal_message_success").text(res.message)

                        $('#ModalSuccess').on('hidden.bs.modal', function() {
                            window.location = "/logfile"
                         });
                    } else {
                        $("#ModalFailed").modal('show')
                        $("#modal_message_failed").text(res.message)

                       
                    }
                },
                error: function (xhr, status, error) {
                    // Handle the error response
                    console.error(error);
                }
            });
        })

    })

</script>
{%- endblock -%}