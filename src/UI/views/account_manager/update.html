{%- extends "layout/base.html" -%}
{%- block content -%}
<div class="container-fluid py-4">
    <div class="row my-4">
        <div class="col-lg-12 col-md-12 mb-md-0 mb-4">
            <div class="card">
                <div class="card-header pb-0">
                    <div class="row">
                        <div class="col-lg-6 col-7">
                            <h6>Add Role Data </h6>
                        </div>
                    </div>
                </div>
                <div class="card-body px-4 pb-2">
                    <div >
                        <div class="mb-3">
                            <label for="name" class="form-label"> Name</label>
                            <input type="text" value="{{data.name}}" name="name" class="form-control" id="name" placeholder=" Name">
                        </div>
                        
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <input type="password" name="password" class="form-control" id="password"
                                placeholder="Password">
                        </div>
                        <div class="mb-3">
                            <label for="role" class="form-label">Choose Role</label>
                            <select class="form-select form-control" aria-label="Default select example" name="role"
                                id="role">
                                <option value="viewer">Viewer</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                        <div class="d-flex justify-content-end">
                            <button class="btn btn-primary" id="addFile">Update</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</main>


{%- endblock -%}

{%- block extrajs -%}


<script>

    $(document).ready(function () {
        $("#addFile").click(function () {
            var name = $("#name").val()
            var password = $("#password").val()
            var role = $("#role").val()

            var postData = new FormData()

            postData.append('name', name)
            postData.append('password', password)
            postData.append('role', role)
            

            $.ajax({
                url: '/account-manager/update/{{email}}', 
                type: 'POST',
                data: postData,
                processData: false, // Prevent jQuery from automatically processing the data
                contentType: false, // Let the server handle the Content-Type
                success: function (res) {  
                    console.log(res)
                    if (res.status == 200) {
                        $("#ModalSuccess").modal('show')
                        $("#modal_message_success").text(res.message)

                        $('#ModalSuccess').on('hidden.bs.modal', function() {
                            window.location = "/account-manager"
                         });
                    } else {
                        $("#ModalFailed").modal('show')
                        $("#modal_message_failed").text(res.message)     
                    }
                },
                error: function (xhr, status, error) {
                    console.error(error);
                }
            });
        })

    })

</script>
{%- endblock -%}